select
  MAR_ADMIN_INFO.ORDER_MED_ID,
  PATIENT.PAT_ID,
  MAR_ADMIN_INFO.MAR_ENC_CSN PAT_ENC_CSN_ID,
  ORDER_MED.MEDICATION_ID,
  CASE WHEN CLARITY_MEDICATION.NAME is null then ORDER_MED.DESCRIPTION else CLARITY_MEDICATION.NAME END MEDICATION,
  MAR_ADMIN_INFO.SIG DOSE,
  MAR_ADMIN_INFO.SCHEDULED_TIME,
  MAR_ADMIN_INFO.TAKEN_TIME, --TIME ACTION WAS TAKEN
  MAR_ADMIN_INFO.SAVED_TIME, --TIME THIS RECORD WAS DOCUMENTED
  ZC_MAR_RSLT.NAME ACTION_TAKEN,
  ZC_MAR_RSN.NAME REASON_ACTION_TAKEN,
  MAR_ADMIN_INFO.COMMENTS,
  ZC_MAR_SITE.NAME SITE,
  MAR_ADMIN_INFO.INFUSION_RATE,
  ORDER_MED.DISCON_TIME,
  ZC_MED_UNIT.NAME UNIT
from
  clr_medications.MAR_ADMIN_INFO
  left join clr_medications.ORDER_MED on MAR_ADMIN_INFO.ORDER_MED_ID = ORDER_MED.ORDER_MED_ID
  left join clr_medications.CLARITY_MEDICATION on CLARITY_MEDICATION.MEDICATION_ID = ORDER_MED.MEDICATION_ID
  left join clr_clarity_reference.ZC_MAR_RSLT on ZC_MAR_RSLT.RESULT_C = MAR_ADMIN_INFO.MAR_ACTION_C
  left join clr_clarity_reference.ZC_MAR_RSN on ZC_MAR_RSN.REASON_C = MAR_ADMIN_INFO.REASON_C
  left join clr_clarity_reference.ZC_MAR_SITE on ZC_MAR_SITE.SITE_C = MAR_ADMIN_INFO.SITE_C
  left join clr_clarity_reference.ZC_MED_UNIT on ZC_MED_UNIT.DISP_QTYUNIT_C = MAR_ADMIN_INFO.MAR_INF_RATE_UNIT_C
  left join clr_encounters.PAT_ENC_HSP on PAT_ENC_HSP.PAT_ENC_CSN_ID = MAR_ADMIN_INFO.MAR_ENC_CSN
  inner join DATABASE.patient on patient.PAT_ID = PAT_ENC_HSP.PAT_ID
where
  MAR_ADMIN_INFO.MAR_ACTION_C != '100' -- MEDICATION DUE ACTION TAKEN
