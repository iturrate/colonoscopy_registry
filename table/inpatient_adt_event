select
        CLARITY_ADT.EVENT_ID,
        CLARITY_ADT.PAT_ID,
        CLARITY_ADT.PAT_ENC_CSN_ID,
        CLARITY_ADT.EFFECTIVE_TIME EFFECTIVE_TIME,
        ZC_EVENT_TYPE.NAME as EVENT_TYPE,
        ZC_PAT_CLASS.NAME as PAT_CLASS,
        ZC_ACCOMMODATION.NAME as ACCOMMODATION,
        ZC_PAT_SERVICE.NAME as PATIENT_SERVICE,
        CLARITY_LOC.LOC_NAME SITE,
        CLARITY_POS.CITY as LOCATION_CITY,
        CLARITY_DEP.DEPARTMENT_ID,
        CLARITY_DEP.DEPARTMENT_NAME,
        ED_ROOM_INFO.ROOM_NUMBER,
        CLARITY_BED.BED_LABEL BED,
        CLARITY_ADT.COMMENTS
from
        clr_encounters.CLARITY_ADT
        inner join DATABASE.patient on patient.PAT_ID = CLARITY_ADT.PAT_ID
        left join clr_clarity_reference.ZC_EVENT_TYPE on CLARITY_ADT.EVENT_TYPE_C = ZC_EVENT_TYPE.EVENT_TYPE_C
        left join clr_providers.CLARITY_DEP on CLARITY_ADT.DEPARTMENT_ID = CLARITY_DEP.DEPARTMENT_ID
        left join clr_providers.CLARITY_LOC on CLARITY_DEP.REV_LOC_ID = CLARITY_LOC.LOC_ID
        left join clr_providers.CLARITY_POS on CLARITY_LOC.LOC_ID = CLARITY_POS.POS_ID
        left join clr_emergency_room.ED_ROOM_INFO on CLARITY_ADT.ROOM_ID = ED_ROOM_INFO.ROOM_ID
        left join clr_clarity_reference.ZC_ACCOMMODATION on CLARITY_ADT.ACCOMMODATION_C = ZC_ACCOMMODATION.ACCOMMODATION_C
        left join clr_clarity_reference.ZC_PAT_CLASS on CLARITY_ADT.PAT_CLASS_C = ZC_PAT_CLASS.ADT_PAT_CLASS_C
        left join clr_clarity_reference.ZC_PAT_SERVICE on CLARITY_ADT.PAT_SERVICE_C = ZC_PAT_SERVICE.HOSP_SERV_C
        left join clr_encounters.CLARITY_BED on CLARITY_BED.BED_CSN_ID = CLARITY_ADT.BED_CSN_ID
where
        CLARITY_ADT.EVENT_SUBTYPE_C != 2 --Cancelled
        and CLARITY_ADT.CANCEL_REASON_C is null
        and CLARITY_ADT.EVENT_TYPE_C in ( 1, 2, 3, 4 ) -- only admission, discharge, transfer in and transfer out. Not census, leavof absence, hospital outpatient
        and CLARITY_ADT.PAT_CLASS_C in ( '101', '103', '104', '112' ) -- inpatient, emergency, observation, hospice
