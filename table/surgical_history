select
  patient.pat_id,
  hsp_enc.encounterepiccsn pat_enc_csn_id,
  SurgicalProcedureEventFact.surgerydatekey surgery_date,
  proceduredim.surgicalprocedureepicid proc_id,
  proceduredim.name procedure_name,
  SurgicalProcedureEventFact.service,
  SurgicalProcedureEventFact.site,
  SurgicalProcedureEventFact.laterality,
  SurgicalProcedureEventFact.anesthesiatype anesthesia_type,
  SurgicalCaseFact.anesthesiastartinstant anesthesia_start,
  surgicalcaseFact.anesthesiastopinstant anesthesia_stop,
  SurgicalProcedureEventFact.woundclass wound_class,
  SurgicalProcedureEventFact.scheduled,
  SurgicalProcedureEventFact.performed,
  SurgicalProcedureEventFact.panel
from
  cogito.SurgicalProcedureEventFact
  left join cogito.proceduredim on proceduredim.procedurekey = SurgicalProcedureEventFact.procedurekey
  left join cogito.encounterfact hsp_enc on hsp_enc.encounterkey = SurgicalProcedureEventFact.hospitalencounterkey
  left join cogito.encounterfact surgery_enc on surgery_enc.encounterkey = SurgicalProcedureEventFact.hospitalencounterkey
  left join cogito.SurgicalCaseFact on SurgicalCaseFact.surgicalcasekey = SurgicalProcedureEventFact.surgicalcasekey
  left join cogito.patientdim on patientdim.patientkey = SurgicalProcedureEventFact.patientkey
  left join DATABASE.patient on patient.pat_id = patientdim.patientepicid
